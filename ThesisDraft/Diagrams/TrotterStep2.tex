\begin{tikzpicture}[inner sep=1mm]
\def \reldist {1.5};
\def \numb {4};
\def \wid {2.3};
\def \size {1.0};
\def \hi {0.8};
\def \rad {0.4};
\def \vert {1.35};


\foreach \i in  {1,...,\numb} {
	\node[operator] (A\i)
	at (\i * \reldist, 0) {};
	\draw[-] (A\i) -- (\i * \reldist , -2.5*\vert);	
};

\foreach \i in {1,...,3} {
    \pgfmathtruncatemacro{\iplusone}{\i + 1};
    \draw[-] (A\i) -- (A\iplusone);
};


\foreach \i in  {1,...,\numb} {
	\draw[-] (A\i) -- (\i * \reldist , -2.6 *\vert);	
};

\node[operator] (d1) at (1 * \reldist, -\vert) {};
\node[operator] (d2) at (2 * \reldist, -\vert) {};
\node[operator] (dd1) at (1 * \reldist, -2*\vert) {};
\node[operator] (dd2) at (2 * \reldist, -2*\vert) {};


\draw[-,line width=0.8mm] (A1) -- (d1);
\draw[-,line width=0.8mm] (A2) -- (d2);
\draw[-,line width=0.8mm] (dd1) -- (d1);
\draw[-,line width=0.8mm] (dd2) -- (d2);

\foreach \i in  {1,...,\numb} {
	\node[operator,minimum width= \hi cm,minimum height= \hi cm] (op\i)
	at (\i * \reldist, -\vert)
	{\scriptsize $\hat{\mathcal{U}}_{U}^{[ \i ]}$};	
};

\foreach \i in {1,3} {
	\pgfmathtruncatemacro{\j}{\i + 1};
    \node[twositeop, minimum width= \wid cm,minimum height= \hi cm,rounded corners = \rad cm] (top\i)
    at (\reldist*\i + \reldist/2, -2*\vert)
    {\small $\hat{\mathcal{U}}_{J}^{[ \i , \j ]} $};
};


\node (dot2) at (\numb * \reldist + 1.4,0) {$\dots$};
\draw[-] (A\numb) -- (dot2);

\foreach \i in  {3,...,\numb} {
	\node[tensorr,minimum width= \size cm,minimum height= \size cm, rounded corners = 0.2cm] (B\i)
	at (\i * \reldist, 0) {$M^{[ \i ]}$};
};
\node[tensor,minimum width= \wid cm,minimum height= \size cm, rounded corners = 0.2cm] (AA) at (\reldist*1 + \reldist/2, 0) {\Large $\Theta$};



	\node (node1) at (\reldist +0.2, -0.5*\vert -0.05) {\small \textbf{1}};
	\node (node2) at (2*\reldist +0.2, -0.5*\vert -0.05) {\textbf{1}};
	\node (node3) at (\reldist +0.2, -1.5*\vert) {\textbf{2}};
	\node (node4) at (2*\reldist +0.2, -1.5*\vert) {\textbf{2}};	
	
\end{tikzpicture}